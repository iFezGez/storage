{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Storage Documentation","text":"<p>Welcome to the Vesta Lab Storage stack.</p> <p>This site covers step-by-step deployment and operations for TrueNAS SCALE 24.04 bare-metal environments.</p>"},{"location":"#contents","title":"Contents","text":"<ul> <li>Installation \u2013 ISO install, disk layout, first boot  </li> <li>Networking \u2013 VLAN 30 setup, bonding, MTU tuning  </li> <li>Dataset Layout \u2013 ZFS datasets, quotas, ACLs  </li> <li>Snapshots \u2013 scheduled tasks, retention, restores  </li> <li>Cloud Sync \u2013 off-site replication to S3 / Swift  </li> <li>SMB / NFS Shares \u2013 permissions, AD/Kerberos integration  </li> <li>Troubleshooting \u2013 common issues and recovery steps</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/","title":"TrueNAS Scale 25.04.1 Documentation","text":"<p>This folder hosts the step-by-step guides for deploying and operating the Vesta Lab storage stack. Each page follows the Vesta Lab documentation template (Quick-view topology, Prerequisites, Steps, Validation, Troubleshooting).</p> Page What you\u2019ll find installation.md Bare-metal deployment of TrueNAS SCALE &amp; CORE, initial networking, subscription keys networking.md VLAN/bridge layout, bond creation, MTU tuning, validation pings volumes.md ZFS pool and dataset creation, filesystem layout, tunables snapshots.md Creating &amp; restoring ZFS snapshots, snapshot schedules, retention policies cloud_sync.md Configuring cloud-sync tasks &amp; remote replication with S3/Swift nfs_exports.md NFS export definitions, permissions, export options &amp; best practices smb_shares.md SMB share setup, ACLs, Windows integration, Kerberos/AD binding nextcloud.md Docker-Compose deployment of Nextcloud, volumes, HTTPS &amp; external storage integration troubleshooting.md Common issues across all services, diagnostic commands &amp; recovery steps"},{"location":"truenas/scale/24.04/bare-metal/docs/#quick-links","title":"Quick links","text":"<ul> <li>Installation guide \u279c <code>installation.md</code> </li> <li>Networking (VLAN &amp; bridges) \u279c <code>network.md</code> </li> <li>ZFS volumes &amp; datasets \u279c <code>volumes.md</code> </li> <li>Snapshots &amp; replication \u279c <code>snapshots.md</code> </li> <li>Cloud sync tasks \u279c <code>cloud_sync.md</code></li> <li>NFS exports \u279c <code>nfs_exports.md</code></li> <li>SMB shares \u279c <code>smb_shares.md</code></li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/cloud_sync/","title":"Cloud-Sync Tasks \u2013 off-site backups","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/cloud_sync/#quick-view-matrix","title":"Quick-view matrix","text":"Task ID Source dataset Direction Schedule Remote path <code>lab-backup</code> <code>core-pool/lab</code> Push Daily 00:00 <code>truenas/lab</code> <code>agency-backup</code> <code>core-pool/agency</code> Push Daily 00:00 <code>truenas/agency</code> <p>All jobs use a single Google Drive OAuth credential and the Copy transfer mode.</p> <p></p>"},{"location":"truenas/scale/24.04/bare-metal/docs/cloud_sync/#prerequisites","title":"Prerequisites","text":"<ul> <li>Cloud credential already created (Google Drive, S3, Azure Blob, \u2026)  </li> <li>Source datasets have daily snapshots (see Scheduled Backups guide)  </li> <li>Adequate upstream bandwidth at midnight</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/cloud_sync/#step-by-step-create-a-task","title":"Step-by-step (create a task)","text":"<ol> <li>Data Protection \u25b8 Cloud Sync Tasks \u25b8 Add </li> <li>Direction \u2192 Push\u2003\u2022 Transfer mode \u2192 Copy </li> <li>Path \u2192 <code>/mnt/core-pool/lab</code> </li> <li>Credential \u2192 Google Drive </li> <li>Remote path \u2192 <code>truenas/lab</code> </li> <li>Schedule \u2192 Daily 00:00 </li> <li>Save &amp; Enable.</li> </ol> <p>Repeat for <code>/mnt/core-pool/agency</code>.</p> <p>Tip: prefer Copy over Sync; it never deletes cloud files if you remove them locally.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/cloud_sync/#monitoring-maintenance","title":"Monitoring &amp; maintenance","text":"Action Frequency Check task status column Daily Review detailed logs Weekly Re-authorise OAuth token Yearly or when prompted <p>Failed transfers raise an alert in the TrueNAS UI; enable email alerts for headless deployments.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/cloud_sync/#next-steps","title":"Next steps","text":"<ul> <li>Configure Periodic Snapshot Tasks first; cloud-sync will copy the underlying dataset blocks.  </li> <li>For on-prem replication, see Scheduled Backups.</li> </ul> <p>Official docs [verified https://www.truenas.com/docs/scale/dataprotection/cloudsync/]</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/","title":"Dataset Structure","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#quick-view-topology","title":"Quick-view topology","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#rationale","title":"Rationale","text":"Tier Main purpose Suggested ACL <code>lab/</code> Homelab automation, backups, repos <code>lab_admins</code> RW \u00b7 <code>lab_users</code> R <code>agency/</code> Company documents, finance, products <code>agency_admins</code> RW \u00b7 role groups R <code>inbox/</code> Staging area for uploads / scans / temp everyone RW \u00b7 nightly purge cronjob"},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#full-layout-datasets-inside-core-pool-only","title":"Full layout \u2013 datasets inside <code>core-pool</code> only","text":"<pre><code>core-pool/\n\u251c\u2500 lab/\n\u2502  \u2514\u2500 backups/\n\u251c\u2500 agency/\n\u2514\u2500 inbox/\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#commands-used","title":"Commands Used","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#-lab-","title":"---------- LAB -----------------------------------------------------------","text":"<p>zfs create core-pool/lab zfs create core-pool/lab/backups</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#-agency-","title":"---------- AGENCY --------------------------------------------------------","text":"<p>zfs create core-pool/agency</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#-inbox-","title":"---------- INBOX ---------------------------------------------------------","text":"<p>zfs create core-pool/inbox</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/datasets/#validation-smoke-test","title":"Validation &amp; smoke test","text":"<p>zfs list -r core-pool</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/installation/","title":"Installation \u2013 TrueNAS SCALE 24.04 (bare-metal)","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/installation/#quick-view-topology","title":"Quick-view topology","text":"Component NIC / VLAN Role Notes truenas-node01 10.30.0.11 Storage head 128 GB system SSD + 4 TB USB HDD <p>Single-node lab build. Add more nodes later for ZFS replication.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Latest TrueNAS SCALE ISO [\u2714 verified https://www.truenas.com/download-truenas-scale/]  </li> <li>USB stick \u2265 8 GB flashed with Balena Etcher or Rufus</li> <li>Physical host with one free disk (this guide uses 4 TB USB HDD for data)</li> <li>IP/DNS reservation: <code>truenas-node01 10.30.0.11</code></li> <li>VGA/ILO or KVM access for initial install</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/installation/#step-1-create-the-installer","title":"Step 1 \u2013 Create the installer","text":"<ol> <li>Download the ISO.  </li> <li>Flash to USB with your preferred tool.  </li> <li>Verify the SHA-256 checksum matches the official site.</li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/installation/#step-2-run-the-text-mode-installer","title":"Step 2 \u2013 Run the text-mode installer","text":"<ol> <li>Boot the server from the USB stick.  </li> <li>Select Install/Upgrade \u2192 choose the system SSD (<code>sda</code>).  </li> <li>Confirm the swap prompt (default size is fine).  </li> <li>Set the root password when asked.</li> </ol> <p>When the summary looks correct, press OK to start the installation.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/installation/#step-3-first-boot-web-login","title":"Step 3 \u2013 First boot &amp; web login","text":"<ol> <li>Remove the USB stick and reboot.  </li> <li>On the console you\u2019ll see the assigned IP, e.g.:</li> </ol> <p>```bash    TrueNAS SCALE 24.04    Web UI: http://10.30.0.11</p> <p></p>"},{"location":"truenas/scale/24.04/bare-metal/docs/nfs_exports/","title":"NFS Export \u2013 lab-backup dataset","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/nfs_exports/#quick-view-table","title":"Quick-view table","text":"Dataset Export path Allowed hosts MapAll user/group <code>core-pool/lab/backups/pbs</code> <code>/mnt/core-pool/lab/backups/pbs</code> <code>10.30.0.2</code> <code>root</code> / <code>root</code>"},{"location":"truenas/scale/24.04/bare-metal/docs/nfs_exports/#prerequisites","title":"Prerequisites","text":"<ul> <li>TrueNAS SCALE 24.04 running  </li> <li>Dataset <code>core-pool/lab/backups/pbs</code> already created  </li> <li>Client <code>10.30.0.2</code> reachable over the storage VLAN  </li> <li>SMB service disabled on this path (to avoid sharing conflicts)</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/nfs_exports/#step-1-create-the-nfs-share-gui","title":"Step 1 \u2013 Create the NFS share (GUI)","text":"Menu path Action Sharing \u25b8 Unix Shares (NFS) \u25b8 Add Path = <code>/mnt/core-pool/lab/backups/pbs</code> Allowed hosts = <code>10.30.0.2</code> MapAll User = root, Group = root Save"},{"location":"truenas/scale/24.04/bare-metal/docs/nfs_exports/#step-2-enable-start-the-nfs-service","title":"Step 2 \u2013 Enable &amp; start the NFS service","text":"Menu Toggle Purpose System \u25b8 Services \u25b8 NFS Start automatically + Start Activates NFS daemon on boot"},{"location":"truenas/scale/24.04/bare-metal/docs/nfs_exports/#step-3-validate-from-a-linux-client","title":"Step 3 \u2013 Validate from a Linux client","text":"<pre><code>showmount -e 10.30.0.11\n</code></pre> <p>sudo mount -t nfs 10.30.0.11:/mnt/core-pool/lab/backups/pbs /mnt/truenas-backup touch /mnt/truenas-backup/test.txt   # write-test umount /mnt/truenas-backup</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/permissions/","title":"Permissions &amp; ACL \u2013 core-pool datasets","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/permissions/#quick-view-matrix","title":"Quick-view matrix","text":"Dataset Protocol ACL type Owner Purpose <code>lab/</code> SMB NFSv4 <code>labuser</code> Windows / macOS lab share <code>agency/</code> SMB NFSv4 <code>agencyuser</code> Business share <code>lab/backups/pbs/</code> NFS POSIX <code>root</code> Backup target for Proxmox Backup Server"},{"location":"truenas/scale/24.04/bare-metal/docs/permissions/#posix-vs-nfsv4-acl-when-to-pick-which","title":"POSIX vs NFSv4 ACL \u2013 when to pick which","text":"Feature POSIX ACL NFSv4 ACL (Windows-style) Best for Linux / NFS Windows / SMB (also macOS) GUI management Limited Full in TrueNAS SCALE Granularity Basic (u/g/o) Fine-grained (read / write / list, inheritance) <p>Rule of thumb \u2022 SMB share \u279c NFSv4 ACL  \u2022 Pure NFS export \u279c POSIX ACL</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/permissions/#configure-lab-dataset-smb-nfsv4","title":"Configure <code>lab/</code> dataset (SMB + NFSv4)","text":"<p>Dataset path: <code>/mnt/core-pool/lab</code></p> <ol> <li>Datasets \u25b8 lab \u25b8 Edit </li> <li>ACL Type \u2192 NFSv4 </li> <li>Apply recursively \u2714  </li> <li>Set ownership </li> <li>Owner User = labuser </li> <li>Owner Group = labuser (optional)  </li> <li>ACL entries </li> <li><code>labuser</code> \u2013 Full control </li> <li><code>root</code>     \u2013 Full control (safety)  </li> <li>Tighten or remove <code>everyone@</code> as required  </li> </ol> <p></p> <ol> <li>Test from Windows <code>\\\\truenas\\lab</code> \u2192 prompt for labuser credentials \u2192 create / delete a file.</li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/permissions/#configure-labbackupspbs-dataset-nfs-posix","title":"Configure <code>lab/backups/pbs/</code> dataset (NFS + POSIX)","text":"<p>Dataset path: <code>/mnt/core-pool/lab/backups/pbs</code></p> <pre><code>chown root:root /mnt/core-pool/lab/backups/pbs\nchmod 770      /mnt/core-pool/lab/backups/pbs\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/permissions/#validation","title":"Validation","text":"<pre><code>nfs4xdr \u2212p /mnt/core-pool/lab\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/permissions/#tips-gotchas","title":"Tips &amp; gotchas","text":"<ul> <li>Use GUI editor for NFSv4 ACLs \u2013 mixing chmod with NFSv4 trees can break inheritance.</li> <li>Restart the SMB service after large ACL changes for Windows clients to re-scan permissions.</li> <li>Snapshot tasks inherit ACLs automatically.</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/pool_config/","title":"ZFS Pool Configuration \u2013 core-pool","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/pool_config/#quick-view-matrix","title":"Quick-view matrix","text":"Setting Value Notes Pool name <code>core-pool</code> Single-disk lab pool Vdev layout 1 \u00d7 stripe 4 TB USB HDD Sector size <code>ashift=12</code> 4 KB alignment, good for SSD/HDD Compression <code>lz4</code> Default for SCALE"},{"location":"truenas/scale/24.04/bare-metal/docs/pool_config/#prerequisites","title":"Prerequisites","text":"<ul> <li>TrueNAS SCALE Web UI available  </li> <li>A spare disk visible as <code>/dev/sdb</code> (<code>4 TB USB HDD</code>)  </li> <li>No important data on that disk \u2013 operation is destructive</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/pool_config/#step-1-create-the-pool-cli","title":"Step 1 \u2013 Create the pool (CLI)","text":"<pre><code>zpool create -f -o ashift=12 core-pool /dev/sdb\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/pool_config/#step-2-enable-compression","title":"Step 2 \u2013 Enable compression","text":"<pre><code>zfs set compression=lz4 core-pool\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/pool_config/#validation","title":"Validation","text":"<pre><code>zpool status core-pool\nzfs get compression core-pool\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/","title":"Scheduled Backup Tasks in TrueNAS SCALE","text":"<p>This document describes how to automate backups in TrueNAS SCALE using scheduled tasks. These include local snapshot creation, remote cloud sync (e.g., Google Drive), and dataset replication (if applicable).</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#1-automatic-snapshot-tasks","title":"1. Automatic Snapshot Tasks","text":"<p>Snapshots are lightweight backups of datasets that can be scheduled periodically.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#steps-to-configure","title":"Steps to Configure:","text":"<ol> <li>Go to Data Protection \u2192 Periodic Snapshot Tasks.</li> <li>Click Add.</li> <li>Select the dataset to snapshot (e.g., <code>core-pool/lab</code>, <code>core-pool/agency</code>).</li> <li>Configure:</li> <li>Recursive: <code>Yes</code> (to include all child datasets).</li> <li>Lifetime: e.g., <code>2 weeks</code> or <code>1 month</code>.</li> <li>Schedule: Define a cron-style schedule or use presets (e.g., daily at 02:00).</li> <li>Click Save and Enable the task.</li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#example","title":"Example:","text":"Setting Value Dataset core-pool/lab Recursive Yes Lifetime 1 month Schedule Daily at 02:00 AM <p>Snapshots can later be used for manual rollback or replication.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#2-cloud-sync-tasks-backups-to-cloud","title":"2. Cloud Sync Tasks (Backups to Cloud)","text":"<p>A Cloud Sync Task uploads or downloads data between a dataset and a cloud storage provider.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#existing-setup","title":"Existing Setup:","text":"<ul> <li>A Cloud Sync task is already configured to upload snapshots to Google Drive.</li> <li>Runs daily at 3:00 AM.</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#steps-to-configure_1","title":"Steps to Configure:","text":"<ol> <li>Go to Data Protection \u2192 Cloud Sync Tasks.</li> <li>Click Add.</li> <li>Configure:</li> <li>Direction: <code>Push</code>.</li> <li>Transfer Mode: <code>Sync</code> or <code>Copy</code> (we recommend <code>Copy</code> for backups).</li> <li>Path: Select dataset path (e.g., <code>/mnt/core-pool/lab/backups</code>).</li> <li>Credential: Google Drive OAuth (already configured).</li> <li>Remote Path: e.g., <code>truenas/lab-backups</code>.</li> <li>Schedule: Daily at your preferred time.</li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#recommended-schedule","title":"Recommended Schedule:","text":"Task Schedule Destination Lab backups to GDrive Daily at 03:00 AM Google Drive Agency backups Weekly on Sunday Google Drive (or other)"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#3-local-replication-tasks-optional","title":"3. Local Replication Tasks (Optional)","text":"<p>If you have a second disk or another dataset for internal backup, TrueNAS allows local replication.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#steps","title":"Steps:","text":"<ol> <li>Go to Data Protection \u2192 Replication Tasks.</li> <li>Click Add.</li> <li>Select:</li> <li>Source Dataset: e.g., <code>core-pool/lab</code>.</li> <li>Destination Dataset: e.g., <code>core-pool/lab/backups</code>.</li> <li>Enable Recursive, Snapshot Replication, and configure schedule.</li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#maintenance-recommendations","title":"Maintenance Recommendations","text":"<ul> <li>Review Cloud Sync logs weekly to ensure successful uploads.</li> <li>Ensure snapshots are retained long enough for rollback if needed.</li> <li>Consider exporting critical snapshots manually before system upgrades.</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/scheduled_backups/#related-files","title":"Related Files","text":"<ul> <li>See <code>snapshots.md</code> for snapshot management and rollback.</li> <li>See <code>cloud_sync.md</code> for cloud provider setup.</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/","title":"SMB / NFS Shares \u2013 core-pool","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/#quick-view-matrix","title":"Quick-view matrix","text":"Share name Dataset path Protocol Access group Purpose root <code>/mnt/core-pool</code> SMB <code>root</code> Admin-level for all data lab <code>/mnt/core-pool/lab</code> SMB <code>labuser</code> Lab services &amp; repos agency <code>/mnt/core-pool/agency</code> SMB <code>agencyuser</code> Business documents lab-backup <code>/mnt/core-pool/lab/backups</code> NFS <code>*</code> (ro) Off-host backups"},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/#prerequisites","title":"Prerequisites","text":"<ul> <li>SMB and NFS services installed (TrueNAS SCALE 24.04 enables both by default)</li> <li>Users created: labuser, agencyuser</li> <li><code>labuser</code> and <code>agencyuser</code> passwords set</li> <li>ACLs on corresponding datasets adjusted (see Permissions guide)</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/#step-1-enable-and-start-smb-service","title":"Step 1 \u2013 Enable and start SMB service","text":"Menu path Action Purpose System \u203a Services \u203a SMB Toggle Start automatically + click Start Keeps SMB up on every boot"},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/#step-2-create-smb-shares-ui","title":"Step 2 \u2013 Create SMB shares (UI)","text":"Menu path Field/value Notes Sharing \u203a Windows (SMB) \u203a Add Path =<code>/mnt/core-pool</code> \u00b7 Name =<code>root</code> Admin share Path =<code>/mnt/core-pool/lab</code> \u00b7 Name =<code>lab</code> Lab share Path =<code>/mnt/core-pool/agency</code> \u00b7 Name =<code>agency</code> Business share"},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/#step-3-enable-shares-at-zfs-level-cli","title":"Step 3 \u2013 Enable shares at ZFS level (CLI)","text":"<pre><code>zfs set sharesmb=on core-pool/lab\nzfs set sharesmb=on core-pool/agency\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/#step-4-create-nfs-export-for-backups","title":"Step 4 \u2013 Create NFS export for backups","text":"<pre><code>zfs set sharenfs=on core-pool/lab/backups\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/smb_shares/#validation","title":"Validation","text":"<p>smbclient -L //truenas -U labuser</p> <p>Windows \u203a \\truenas\\agency</p> <p>showmount -e truenas</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/","title":"Snapshot Restoration \u2013 TrueNAS SCALE","text":"<p>Snapshots are point-in-time copies of datasets. You can:</p> <ul> <li>Browse them (Shadow Copies)  </li> <li>Clone to a separate dataset for granular restore  </li> <li>Rollback an entire dataset after ransomware or data loss</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/#1-list-available-snapshots","title":"1 \u2013 List available snapshots","text":"<ol> <li>Datasets \u25b8 locate the dataset  </li> <li>Click the \u22ee (three-dots) \u25b8 View Snapshots </li> <li>All snapshot names + timestamps appear.</li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/#2-restore-individual-files-windows-shadow-copy","title":"2 \u2013 Restore individual files (Windows Shadow Copy)","text":"<ol> <li>Open File Explorer \u2192 <code>\\\\10.30.0.11\\lab</code> </li> <li>Right-click folder \u25b8 Restore previous versions </li> <li>Select a snapshot \u2192 Open (browse) or Restore (overwrite)</li> </ol> <p>Requires <code>vfs_shadow_copy2</code> enabled in SMB service.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/#3-clone-a-snapshot-gui","title":"3 \u2013 Clone a snapshot (GUI)","text":"<ol> <li>Datasets \u25b8 View Snapshots </li> <li>\u22ee next to snapshot \u25b8 Clone to New Dataset </li> <li>Name it e.g. <code>restore-lab-YYYY-MM-DD</code> \u25b8 Submit</li> </ol> <p>The clone appears as a separate dataset; share it temporarily to extract files.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/#4-rollback-an-entire-dataset","title":"4 \u2013 Rollback an entire dataset","text":"<p>Danger: all changes after the snapshot are deleted.</p> <ol> <li>View Snapshots \u25b8 \u22ee on snapshot  </li> <li>Rollback \u25b8 Confirm dialog</li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/#5-cli-examples","title":"5 \u2013 CLI examples","text":"<pre><code># Roll back dataset to a specific snap\nzfs rollback core-pool/lab@auto-2025-07-08_00-00\n\n# Clone a snapshot\nzfs clone core-pool/lab@auto-2025-07-08_00-00 \\\n          core-pool/restore-lab-2025-07-08\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/#best-practices","title":"Best practices","text":"Tip Why Take snapshots before risky changes Quick safety net Use recursive snapshots Captures child datasets Combine with Cloud-Sync or Replication Off-site protection"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshot_restoration/#related-guides","title":"Related guides","text":"<p>-Periodic Snapshots  -Cloud-Sync Tasks</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshots/","title":"Periodic Snapshot Tasks \u2013 core-pool","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/snapshots/#quick-view-matrix","title":"Quick-view matrix","text":"Dataset Schedule Retention <code>core-pool/lab</code> Daily 00:00 2 weeks <code>core-pool/agency</code> Daily 00:00 2 weeks <p>Snapshots are read-only, space-efficient checkpoints\u2014ideal for ransomware roll-back and replication.</p> <p></p>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshots/#gui-configuration","title":"GUI configuration","text":"<ol> <li>Data Protection \u25b8 Periodic Snapshot Tasks \u25b8 Add </li> <li>Dataset \u2192 <code>core-pool/lab</code>\u2003\u2022 Recursive \u2714  </li> <li>Schedule \u2192 preset Daily 00:00 </li> <li>Lifetime \u2192 2 weeks </li> <li>Save and Enable.  </li> <li>Repeat for <code>core-pool/agency</code>.</li> </ol> <p>Tip: staggering start times (e.g., 00:05, 00:10) avoids disk-IO spikes on large pools.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/snapshots/#cli-helpers","title":"CLI helpers","text":"<pre><code># Take an ad-hoc snapshot\nzfs snapshot core-pool/lab@manual-backup-$(date +%F)\n\n# List the newest five snapshots\nzfs list -t snapshot -o name,creation -s creation | tail -5\n\n# Delete old snapshots\nzfs destroy core-pool/lab@manual-backup-$(date +%F -d '-2 weeks')\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/vlan_networking/","title":"VLAN Networking \u2013 TrueNAS SCALE","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/vlan_networking/#quick-view-matrix","title":"Quick-view matrix","text":"VLAN CIDR Tagged interface Role / Notes 30 10.30.0.0/24 <code>vlan30</code> Storage traffic + Web UI 40 10.40.0.0/24 (future) Backup / replication"},{"location":"truenas/scale/24.04/bare-metal/docs/vlan_networking/#prerequisites","title":"Prerequisites","text":"<ul> <li>TrueNAS SCALE 24.04 freshly installed (no IP configured yet)</li> <li>at least one trunk port on the switch carrying VLAN 30 (and 40 later)</li> <li>Interface names in this guide:  </li> <li><code>enxe04c365168</code> \u2192 physical NIC (UP)  </li> <li><code>enp0s25</code>       \u2192 unused spare (DOWN)</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/vlan_networking/#step-1-create-the-vlan-interface-ui","title":"Step 1 \u2013 Create the VLAN interface (UI)","text":"Menu path Action Purpose Network \u25b8 Interfaces \u25b8 Add Select Parent = enxe04c365168Type = VLANID = 30Name = vlan30 Creates tagged interface vlan30 \u25b8 Edit Set IP Address = 10.30.0.11/24 Mgmt &amp; storage subnet"},{"location":"truenas/scale/24.04/bare-metal/docs/vlan_networking/#step-2-validation","title":"Step 2 \u2013 Validation","text":"<pre><code>ping -c3 10.30.0.1\nip -c addr show vlan30\n</code></pre>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/","title":"Accessing and Uploading Files from Windows to TrueNAS SCALE","text":"<p>This guide explains how to access and upload files to TrueNAS SCALE SMB shares from a Windows client.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#prerequisites","title":"Prerequisites","text":"<ul> <li>A functioning TrueNAS SCALE system.</li> <li>SMB shares properly configured (e.g., <code>/mnt/core-pool/lab</code>, <code>/mnt/core-pool/agency</code>).</li> <li>At least one user with permissions to access the share (e.g., <code>labuser</code>, <code>agencyuser</code>).</li> <li>Your Windows client must be on the same network or able to reach the TrueNAS IP (e.g., <code>10.30.0.11</code>).</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#steps","title":"Steps","text":""},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#1-open-file-explorer","title":"1. Open File Explorer","text":"<p>On your Windows machine:</p> <ol> <li>Press <code>Windows + E</code> to open File Explorer.</li> <li>In the address bar, type:    <code>\\\\10.30.0.11\\lab</code>    or    <code>\\\\10.30.0.11\\agency</code></li> <li>Press <code>Enter</code>.</li> </ol> <p>Replace <code>10.30.0.11</code> with your TrueNAS IP if different.</p>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#2-authenticate","title":"2. Authenticate","text":"<ol> <li>When prompted, enter the credentials for the SMB user:</li> <li>Username: <code>labuser</code> or <code>agencyuser</code></li> <li> <p>Password: [set during user creation]</p> </li> <li> <p>Check \u201cRemember my credentials\u201d if you want to avoid logging in every time.</p> </li> </ol>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#3-upload-files","title":"3. Upload Files","text":"<p>You can now:</p> <ul> <li>Drag and drop files into the window.</li> <li>Create new folders.</li> <li>Rename and delete files if you have permission.</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#4-optional-map-network-drive","title":"4. Optional \u2013 Map Network Drive","text":"<p>To make the share persistent on reboot:</p> <ol> <li>Right-click on <code>This PC</code> &gt; <code>Map network drive\u2026</code>.</li> <li>Choose a drive letter (e.g., <code>Z:</code>).</li> <li>For folder, enter the path (e.g., <code>\\\\10.30.0.11\\lab</code>).</li> <li>Check \u201cReconnect at sign-in\u201d and click <code>Finish</code>.</li> </ol> <p></p>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#troubleshooting","title":"Troubleshooting","text":"<ul> <li>Can't connect: Ensure TrueNAS IP is reachable and SMB service is running.</li> <li>Access denied: Verify the user has permissions on the dataset.</li> <li>Slow file access: Check for network bottlenecks or try using gigabit Ethernet.</li> </ul>"},{"location":"truenas/scale/24.04/bare-metal/docs/windows_file_access/#result","title":"Result","text":"<p>Your Windows client can now access and manage files in your TrueNAS SCALE SMB shares efficiently.</p>"},{"location":"truenas/scale/24.04/bare-metal/scripts/","title":"Scripts \u2013 TrueNAS SCALE 24.04 (bare\u2011metal)","text":"Script Descripci\u00f3n Seguro repetir 01_bootstrap_network.sh Crea VLAN 30 (<code>ix0.30</code>) con IP 10.30.0.21/24 y gateway 10.30.0.1 \u2714 02_create_pool.sh Crea <code>core-pool</code> con disco dado (<code>/dev/disk/by-id/...</code>) \u2714 03_datasets.sh Genera jerarqu\u00eda de datasets leyendo exports/datasets_definition.json \u2714 04_shares_smb_nfs.sh Registra shares SMB/NFS seg\u00fan exports/shares_definition.json \u2714 backup_config.sh Guarda backup de configuraci\u00f3n en exports/.tar* \u2714 <p>Todos los scripts son idempotentes: si el recurso existe, se omite.</p>"},{"location":"truenas/scale/24.04/bare-metal/templates/","title":"Templates","text":"File Purpose <code>docker-compose.yaml</code> Production\u2011ready stack for Nextcloud\u00a027 with MariaDB, Redis and Caddy reverse proxy. <code>cloud-init-scale.yaml</code> Minimal cloud\u2011init to auto\u2011install TrueNAS SCALE\u00a024.04 on a bare\u2011metal/VM instance. <p>Edit variables (<code>MYSQL_ROOT_PASSWORD</code>, SSH key, etc.) before deployment.</p>"}]}